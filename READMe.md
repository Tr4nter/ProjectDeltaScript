this is a fork of a project delta script, with refinements